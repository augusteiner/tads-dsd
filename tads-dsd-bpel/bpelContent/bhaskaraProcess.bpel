<!-- bhaskaraProcess BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Mon Jul 03 18:36:32 BRT 2017 -->
<bpel:process name="bhaskaraProcess" targetNamespace="http://tads.ifrn.edu.br/math/"
  suppressJoinFailure="yes" xmlns:tns="http://tads.ifrn.edu.br/math/"
  xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable">

  <!-- Import the client WSDL -->
  <bpel:import namespace="http://tads.ifrn.edu.br/math/"
    location="math.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
  <bpel:import location="bhaskaraProcessArtifacts.wsdl"
    namespace="http://tads.ifrn.edu.br/math/" importType="http://schemas.xmlsoap.org/wsdl/" />

  <!-- ================================================================= -->
  <!-- PARTNERLINKS -->
  <!-- List of services participating in this BPEL process -->
  <!-- ================================================================= -->
  <bpel:partnerLinks>
    <!-- The 'client' role represents the requester of this service. -->
    <bpel:partnerLink name="client" partnerLinkType="tns:bhaskaraProcess"
      myRole="bhaskaraProcessProvider" />

    <bpel:partnerLink name="deltaPL" partnerLinkType="tns:deltaPLT"
      partnerRole="deltaPLRole"></bpel:partnerLink>
    <bpel:partnerLink name="bhaskaraPL"
      partnerLinkType="tns:bhaskaraPLT" partnerRole="bhaskaraPLRole"></bpel:partnerLink>
  </bpel:partnerLinks>

  <!-- ================================================================= -->
  <!-- VARIABLES -->
  <!-- List of messages and XML documents used within this BPEL process -->
  <!-- ================================================================= -->
  <bpel:variables>
    <!-- Reference to the message passed as input during initiation -->
    <bpel:variable name="input"
      messageType="tns:bhaskaraProcessRequestMessage" />

    <!-- Reference to the message that will be returned to the requester -->
    <bpel:variable name="output"
      messageType="tns:bhaskaraProcessResponseMessage" />
    <bpel:variable name="deltaPLResponse" messageType="tns:deltaResponse"></bpel:variable>
    <bpel:variable name="deltaPLRequest" messageType="tns:deltaRequest"></bpel:variable>
    <bpel:variable name="bhaskaraPLResponse" messageType="tns:bhaskaraResponse"></bpel:variable>
    <bpel:variable name="bhaskaraPLRequest" messageType="tns:bhaskaraRequest"></bpel:variable>
  </bpel:variables>

  <!-- ================================================================= -->
  <!-- ORCHESTRATION LOGIC -->
  <!-- Set of activities coordinating the flow of messages across the -->
  <!-- services integrated within this business process -->
  <!-- ================================================================= -->
  <bpel:sequence name="main">

    <!-- Receive input from requester. Note: This maps to operation defined 
      in bhaskaraProcess.wsdl -->
    <bpel:receive name="receiveInput" partnerLink="client"
      portType="tns:bhaskaraProcess" operation="process" variable="input"
      createInstance="yes" />

    <bpel:assign validate="no" name="assignInputToDeltaWS">
      <bpel:copy>
        <bpel:from>
          <bpel:literal>
            <tns:entradaTernaria xmlns:tns="http://tads.ifrn.edu.br/math/"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <a>0.0</a>
              <b>0.0</b>
              <c>0.0</c>
            </tns:entradaTernaria>
          </bpel:literal>
        </bpel:from>
        <bpel:to variable="deltaPLRequest" part="parameters"></bpel:to>
      </bpel:copy>
      <bpel:copy>
        <bpel:from part="payload" variable="input">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:a]]></bpel:query>
        </bpel:from>
        <bpel:to part="parameters" variable="deltaPLRequest">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[a]]></bpel:query>
        </bpel:to>
      </bpel:copy>
      <bpel:copy>
        <bpel:from part="payload" variable="input">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:b]]></bpel:query>
        </bpel:from>
        <bpel:to part="parameters" variable="deltaPLRequest">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[b]]></bpel:query>
        </bpel:to>
      </bpel:copy>
      <bpel:copy>
        <bpel:from part="payload" variable="input">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:c]]></bpel:query>
        </bpel:from>
        <bpel:to part="parameters" variable="deltaPLRequest">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[c]]></bpel:query>
        </bpel:to>
      </bpel:copy>
    </bpel:assign>
    <bpel:invoke name="invokeDeltaWS" partnerLink="deltaPL"
      operation="delta" portType="tns:DeltaInterface" inputVariable="deltaPLRequest"
      outputVariable="deltaPLResponse"></bpel:invoke>
    <bpel:assign validate="no" name="assignDeltaOutputToBhaskaraWS">
      <bpel:copy>
        <bpel:from>
          <bpel:literal>
            <tns:entradaBhaskara xmlns:tns="http://tads.ifrn.edu.br/math/"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <a>0.0</a>
              <b>0.0</b>
              <delta>0.0</delta>
            </tns:entradaBhaskara>
          </bpel:literal>
        </bpel:from>
        <bpel:to variable="bhaskaraPLRequest" part="parameters"></bpel:to>
      </bpel:copy>

      <bpel:copy>
        <bpel:from part="payload" variable="input">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:a]]></bpel:query>
        </bpel:from>
        <bpel:to part="parameters" variable="bhaskaraPLRequest">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[a]]></bpel:query>
        </bpel:to>

      </bpel:copy>

      <bpel:copy>
        <bpel:from part="payload" variable="input">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:b]]></bpel:query>
        </bpel:from>
        <bpel:to part="parameters" variable="bhaskaraPLRequest">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[b]]></bpel:query>
        </bpel:to>

      </bpel:copy>
      <bpel:copy>
        <bpel:from part="parameters" variable="deltaPLResponse">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[r]]>
          </bpel:query>

        </bpel:from>
        <bpel:to part="parameters" variable="bhaskaraPLRequest">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[delta]]></bpel:query>
        </bpel:to>

      </bpel:copy>
    </bpel:assign>

    <!-- Generate reply to synchronous request -->
    <bpel:invoke name="invokeBhaskaraWS" partnerLink="bhaskaraPL"
      operation="bhaskara" portType="tns:BhaskaraInterface"
      inputVariable="bhaskaraPLRequest" outputVariable="bhaskaraPLResponse"></bpel:invoke>
    <bpel:assign validate="no"
      name="assignBhaskaraOutputToReplyOutput">
      <bpel:copy>
        <bpel:from>
          <bpel:literal>
            <tns:bhaskaraProcessResponse
              xmlns:tns="http://tads.ifrn.edu.br/math/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
              <tns:x1>0.0</tns:x1>
              <tns:x2>0.0</tns:x2>
            </tns:bhaskaraProcessResponse>
          </bpel:literal>
        </bpel:from>
        <bpel:to variable="output" part="payload"></bpel:to>
      </bpel:copy>
      <bpel:copy>
        <bpel:from part="parameters" variable="bhaskaraPLResponse">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[x1]]></bpel:query>
        </bpel:from>
        <bpel:to part="payload" variable="output">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:x1]]></bpel:query>
        </bpel:to>
      </bpel:copy>
      <bpel:copy>
        <bpel:from part="parameters" variable="bhaskaraPLResponse">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[x2]]></bpel:query>
        </bpel:from>
        <bpel:to part="payload" variable="output">
          <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:x2]]></bpel:query>
        </bpel:to>
      </bpel:copy>
    </bpel:assign>
    <bpel:reply name="replyOutput" partnerLink="client"
      portType="tns:bhaskaraProcess" operation="process" variable="output" />
  </bpel:sequence>
</bpel:process>

